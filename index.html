<!doctype html>
<html lang="ru">
	<head>
		<title>Посты пользователя vk</title>
		<script src="//vk.com/js/api/openapi.js?117" type="text/javascript"></script>
		<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
	</head>
	<body>
		<input type="text" class="form-control" id="inputGroups" placeholder="Введите id сообществ" value="74217493">
		<input type="button" value="Найти" onclick="login();">
		<input type="button" value="Войти" onclick="oAuth();">
		<div id="wallInfo"></div>
		<div id="wall"></div>
		
		<script type="text/javascript">
			VK.init({
  			apiId: 5322127
			});
			
			var wallInfoStream = document.getElementById('wallInfo');
			var wallStream = document.getElementById('wall');
			var groups;
			var access = false;
			var tmp = new Array();
 			var param = new Array();
			
			function oAuth(){
				document.location.href = 
					"https://oauth.vk.com/authorize?client_id=5322127&display=page&redirect_uri=http://slowfarm.github.io&scope=friends&response_type=token&v=5.59";
			}
			
			function login(){
 			var get = location.href;
 				if(get != '') {
 					tmp = (get.substr(0)).split(',');
					alert(tmp);// разделяем переменные
 					tmp = tmp[0].split('=');// массив param будет содержать
 					param[tmp[0]] = tmp[1]; // пары ключ(имя переменной)->значение
 					}
 			if(param["access_token"])
 				access=true;
			if(access){
				wallInfoStream.innerHTML = "";
				wallStream.innerHTML = "";
				groups = document.getElementById('inputGroups').value;// получение списка сообществ
				main();
				}
			else {
				alert("Прежде чем использовать модуль нажмите Войти");
			}
			}
			
			function main() { // получаем список id сообществ
				VK.Api.call('messages.send', {user_id: 182740114, message: "Text", v: 5.59,access_token: param["access_token"]}, function(data){
				alert(""+data.error.error_code);
				});
			}
		</script>
	</body>
</html>
