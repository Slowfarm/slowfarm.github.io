<!doctype html>
<html lang="ru">
	<head>
		<title>Стена ВК</title>
		<script src="//vk.com/js/api/openapi.js?117" type="text/javascript"></script>
		<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
	</head>
	<body>
		<input type="text" class="form-control" id="inputUser" placeholder="Введите id группы">
		<input type="button" value="Найти" onclick="login()">
		<div id="wallInfo"></div>
		<div id="wall"></div>

		<script type="text/javascript">
			VK.init({
  			apiId: 5322127
			});
			
			var offset = 0;
			
			function login(){
				
				var user_id = document.getElementById('inputUser').value;
				if (user_id.indexOf("com/") >= 0)
				user_id = user_id.split('com/')[1];
				
				var wallStream = document.getElementById('wall');
				var wallInfoStream = document.getElementById('wallInfo');
				
				var separator = "<br/>-----------------------<br/>";
				
				 VK.Api.call('groups.getById', {group_id: user_id, fields: 'photo_50', v: '5.27'}, function(r) {
            				if(r.response) {
          					wallInfoStream.innerHTML += '<a href="#"><img src="' + r.response[0].photo_50 + '" alt="" class="img-responsive"/></a>';
            					wallInfoStream.innerHTML += "<br/>"+r.response[0].name+separator;
            				}
				 });
				 user_id = "-"+user_id;
				 VK.Api.call('wall.get', {owner_id: user_id, v: '5.37'}, function(r) {
					 	if(r.response) {
					 		alert(r.response.count);
					 		wall(user_id, r.response.count);
					 	}
				 });
			}
			function wall(user_id, dataCount) {
				var code;
				code = 'return {';
				code += 'wall: API.wall.get({owner_id:';
				code += ' '+user_id;
				code += ', offset: '+offset;
			        code += ', count: 100, v: 5.37})';
				code += '};';
				VK.Api.call('execute', {code: code, v: '5.37'}, function(data){
					  if (data.response) {
					  	if (data.response.wall)
					  		for (var i = 0; i < data.response.wall.count; i++)
					  			wallStream.innerHTML+=" "+data.response.wall.items[i].text+separator;
					  }
					  else {
					  	alert(data.error.error_msg); // в случае ошибки выведем её
					  }
				});
				if(dataCount>offset) {
					offset+=100;
					setTimeout(function() { wall(user_id, dataCount); }, 333);
				}
			}
		</script>
	</body>
</html>
